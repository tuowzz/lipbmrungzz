<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Magic Glow Lipstick | M-BLITHE ปากชุ่มชื้น ไม่แห้งแตก</title>
  <meta name="description" content="ลิปสติกบำรุงริมฝีปาก Magic Glow จาก M-BLITHE ชุ่มชื้นยาวนาน ปากดูสุขภาพดี 6 เฉดสี พร้อมส่ง ส่งฟรี เก็บเงินปลายทาง">
  <link rel="canonical" href="https://tuowzz.github.io/mbshopz.github.io/magicglow" />

  <!-- Pixels (ตามเดิม) -->
  <script>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
    n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}
    (window,document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init','127978927946856'); fbq('track','PageView'); fbq('track','ViewContent');
  </script>
  <noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=127978927946856&ev=PageView&noscript=1"/></noscript>

  <script>
    !function(w,d,t){w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=
    ["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie"];
    ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat([].slice.call(arguments,0)))}};
    for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);
    ttq.load=function(e,n){var i="https://analytics.tiktok.com/i18n/pixel/events.js";
      ttq._i=ttq._i||{};ttq._i[e]=[];ttq._i[e]._u=i;ttq._t=ttq._t||{};ttq._t[e]=+new Date;ttq._o=ttq._o||{};
      ttq._o[e]=n||{};var o=d.createElement("script");o.type="text/javascript";o.async=!0;o.src=i+"?sdkid="+e+"&lib="+t;
      var a=d.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)};
    ttq.load("D0EVS2JC77U9C23772EG"); ttq.page(); ttq.track("ViewContent");
  }(window,document,"ttq");
  </script>

  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17035064059"></script>
  <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);} gtag('js',new Date()); gtag('config','AW-17035064059');</script>

  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <style>
    :root{--primary:#ee4d2d;--brand:#e94057;--bg:#f6f7fb;--card:#fff;--line:#eee;--text:#161823;--muted:#888;--shadow:0 2px 18px rgba(0,0,0,.06);--r:14px}
    *{box-sizing:border-box}body{font-family:'Kanit',sans-serif;margin:0;background:var(--bg);color:var(--text);padding-bottom:76px}
    header{background:#fff;box-shadow:var(--shadow);position:sticky;top:0;z-index:50}
    .topbar{display:flex;justify-content:space-between;align-items:center;padding:10px 14px}
    .left{display:flex;gap:10px;align-items:center}
    .logo{width:38px;height:38px;border-radius:50%;background:linear-gradient(135deg,#ff7e5f,#feb47b);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800}
    .line-top{display:inline-flex;gap:8px;align-items:center;background:#06c755;color:#fff;text-decoration:none;padding:8px 12px;border-radius:10px;font-weight:800;box-shadow:0 2px 10px rgba(6,199,85,.12)}
    .hero img{width:100%;display:block}
    .voucher-row{display:flex;gap:8px;padding:10px 14px;background:#fff}
    .voucher{flex:1;border:1px dashed var(--primary);border-radius:10px;padding:8px 10px;font-weight:700;color:var(--primary);text-align:center}
    .card{background:var(--card);border-radius:0 0 var(--r) var(--r);box-shadow:var(--shadow);margin-bottom:10px}
    .pad{padding:14px}
    .price{color:var(--primary);font-size:2rem;font-weight:800}
    .price-old{color:#b0b0b0;text-decoration:line-through;margin-left:8px}
    .rating{display:flex;gap:10px;align-items:center;color:#555;margin-top:6px}
    .stars{color:#f9d71c}
    .badges{display:flex;gap:6px;flex-wrap:wrap;margin-top:8px}
    .badge{font-size:.9rem;font-weight:700;border-radius:6px;padding:3px 8px;background:#fff5ef;border:1px solid #ffd6c9;color:#c23a1a}
    .divider{height:1px;background:#f0f0f0;margin:12px 0}
    .options{display:flex;gap:9px;flex-wrap:wrap}
    .chip{border:1.8px solid #eee;background:#fff;border-radius:10px;padding:8px 12px;font-weight:700;cursor:pointer}
    .chip.selected{border-color:var(--primary);background:#ffe7df;color:#c23a1a;box-shadow:0 1px 6px #ffbfab66}
    .qty{display:flex;align-items:center;gap:10px}
    .step{display:inline-flex;align-items:center;gap:10px;border:1px solid #eee;border-radius:10px;padding:6px}
    .step button{border:none;background:#fff;width:30px;height:30px;border-radius:8px;cursor:pointer}
    .step input{width:46px;border:none;text-align:center;font-weight:700}
    .thumb-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
    .thumb-grid img{width:100%;border-radius:12px;box-shadow:0 2px 8px #0001}
    .sticky{position:fixed;left:0;right:0;bottom:0;display:flex;height:62px;background:#fff;border-top:1px solid #eee;box-shadow:0 -2px 14px rgba(0,0,0,.08);z-index:60}
    .btn{display:flex;align-items:center;justify-content:center;font-weight:800;border:none;cursor:pointer}
    .btn-line{width:40%;background:#06c755;color:#fff;text-decoration:none}
    .btn-buy{width:60%;background:var(--primary);color:#fff;font-size:1.14rem}
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;z-index:80}
    .sheet{position:absolute;left:0;right:0;bottom:0;background:#fff;border-radius:18px 18px 0 0;box-shadow:var(--shadow);padding:16px;animation:slideUp .18s;max-height:93vh;overflow:auto}
    @keyframes slideUp{from{transform:translateY(30%);opacity:.4}to{transform:translateY(0);opacity:1}}
    .close{position:absolute;right:14px;top:10px;font-size:1.4rem;color:#bbb;cursor:pointer}
    .sheet-h{display:flex;gap:12px;align-items:center;border-bottom:1px solid #f0f0f0;padding-bottom:10px;margin-bottom:10px}
    .sheet-h img{width:64px;height:64px;border-radius:10px;border:1px solid #eee;object-fit:cover}
    .form label{display:block;font-weight:700;margin:10px 0 6px}
    .form input,.form textarea{width:100%;padding:12px;border:1px solid #ccc;border-radius:8px;font-family:'Kanit',sans-serif}
    .submit{width:100%;margin-top:12px;background:var(--primary);color:#fff;border:none;border-radius:10px;padding:14px;font-weight:800;cursor:pointer}
    .submit:disabled{background:#ddd}
    .toast{display:none;position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);background:#fff;border-radius:16px;padding:26px 36px;box-shadow:var(--shadow);z-index:200;text-align:center}
    .toast i{font-size:2.6rem;color:var(--brand)}
  </style>
</head>
<body>
  <header>
    <div class="topbar">
      <div class="left">
        <div class="logo">MB</div>
        <div>
          <div style="font-weight:700">M-BLITHE Official</div>
          <div style="font-size:.9rem;color:#666">ของแท้ 100% • ส่งฟรี • เก็บเงินปลายทาง</div>
        </div>
      </div>
      <a href="https://lin.ee/wKelfsp" target="_blank" class="line-top" id="lineTop"><i class="fa-brands fa-line"></i> แอดไลน์รับโปร</a>
    </div>
  </header>

  <section class="hero">
    <img src="magicglow_hero.png" alt="M-BLITHE Magic Glow">
    <div class="voucher-row">
      <div class="voucher">คูปอง ฿20 ขั้นต่ำ ฿199</div>
      <div class="voucher">ลดเพิ่ม ฿10 โค้ด: GLOW10</div>
    </div>
  </section>

  <section class="card">
    <div class="pad">
      <div style="display:flex;align-items:flex-end"><div class="price">฿199</div><div class="price-old">฿259</div></div>
      <div class="rating"><span class="stars">★★★★★</span><span>4.9</span><span style="color:#666">| ขายแล้ว 3.1k</span></div>
      <div class="badges"><span class="badge">ส่งฟรี</span><span class="badge">พร้อมส่ง</span></div>

      <div class="divider"></div>

      <div style="font-weight:700;margin-bottom:6px">เลือกเฉดสี Magic Glow</div>
      <div class="options" id="opt"></div>

      <div class="divider"></div>

      <div class="qty">
        <div style="font-weight:700">จำนวน</div>
        <div class="step">
          <button type="button" id="minus">−</button>
          <input id="qty" type="number" min="1" value="1">
          <button type="button" id="plus">+</button>
        </div>
      </div>
    </div>
  </section>

  <section class="card">
    <div class="pad">
      <h3 style="margin:0 0 8px 0;font-size:1.02rem">✨ Magic Glow 6 สี</h3>
      <div class="thumb-grid">
        <img src="831.jpg" alt="831 Bewitching Berry - ลิปสติกสีเบอร์รี่ ปากชมพูอมแดง สุขภาพดี Magic Glow M-BLITHE">
        <img src="832.jpg" alt="832 Mystic Merlot - ลิปสติกสีไวน์แดง บำรุงริมฝีปากนุ่มชุ่มชื้น ไม่แห้งแตก">
        <img src="833.jpg" alt="833 Moon Beam - ลิปสติกสีชมพูอ่อนธรรมชาติ ปากดูใส สุขภาพดี">
        <img src="834.jpg" alt="834 Forbidden Potion - ลิปสติกสีชมพูสด เติมความชุ่มชื้น ริมฝีปากอิ่มน้ำ">
        <img src="835.jpg" alt="835 Crimson Charm - ลิปสติกสีแดงอมชมพู ปากนุ่มน่าสัมผัส บำรุงไม่คล้ำ">
        <img src="836.jpg" alt="836 Lunar Lust - ลิปสติกสีชมพูพีชธรรมชาติ ใช้ได้ทุกวัน ปากดูอ่อนเยาว์">
      </div>
    </div>
  </section>

  <div class="sticky">
    <a href="https://lin.ee/wKelfsp" target="_blank" class="btn btn-line" id="lineBottom"><i class="fa-brands fa-line" style="margin-right:8px"></i>แอดไลน์รับโปร</a>
    <button class="btn btn-buy" id="buy">ซื้อเลย</button>
  </div>

  <!-- Sheet -->
  <div class="overlay" id="sheet">
    <div class="sheet">
      <i class="fa-solid fa-xmark close" id="close"></i>
      <div class="sheet-h">
        <img src="magicglow_thumb.png" alt="Magic Glow">
        <div>
          <div style="font-weight:700">M-BLITHE Magic Glow Lipstick</div>
          <div style="color:#ee4d2d;font-weight:800">฿199</div>
        </div>
      </div>

      <div style="font-weight:700;margin-bottom:6px">เลือกเฉดสี</div>
      <div class="options" id="optM" style="margin-bottom:8px"></div>

      <div class="qty" style="margin-bottom:8px">
        <div style="font-weight:700">จำนวน</div>
        <div class="step">
          <button type="button" id="mMinus">−</button>
          <input id="mQty" type="number" min="1" value="1">
          <button type="button" id="mPlus">+</button>
        </div>
      </div>

      <!-- ส่งเฉพาะ 5 ฟิลด์: order_id, product, name, phone, address -->
      <form id="orderForm" class="form" onsubmit="sendOrder(event)" autocomplete="off">
        <input type="hidden" name="order_id" id="order_id">
        <input type="hidden" name="product" id="product">

        <label for="name">ชื่อ-นามสกุล</label>
        <input id="name" name="name" required placeholder="กรอกชื่อ-นามสกุล">

        <label for="phone">เบอร์โทรศัพท์</label>
        <input id="phone" name="phone" required placeholder="0812345678" pattern="^[0-9]{10}$" title="กรอกเบอร์โทร 10 หลัก">

        <label for="address">ที่อยู่จัดส่ง</label>
        <textarea id="address" name="address" rows="3" required placeholder="บ้านเลขที่, ถนน, ตำบล, อำเภอ, จังหวัด, รหัสไปรษณีย์"></textarea>

        <button class="submit" id="submitBtn" type="submit">ยืนยันสั่งซื้อ</button>
      </form>
    </div>
  </div>

  <div class="toast" id="toast">
    <i class="fa-solid fa-circle-check"></i>
    <div style="margin-top:6px;font-weight:800">สั่งซื้อสำเร็จ!</div>
    <div style="color:#333;margin-top:4px">เจ้าหน้าที่จะติดต่อยืนยันออเดอร์</div>
  </div>

  <script>
    // ===== CONFIG =====
    const APP_URL = 'https://script.google.com/macros/s/AKfycbwLLvLNMk7QqkYIyPgN5efEqcpFzFtEYxuWiCBld5hQvlOf8t8v6vMI19A5q7Dk0-JE0g/exec';
    const PRICE = 199;
    const SHADES = [
      {id:'831', text:'831 Bewitching Berry (เบอร์รี่)'},
      {id:'832', text:'832 Mystic Merlot (ไวน์แดง)'},
      {id:'833', text:'833 Moon Beam (ชมพูอ่อน)'},
      {id:'834', text:'834 Forbidden Potion (ชมพูสด)'},
      {id:'835', text:'835 Crimson Charm (แดงอมชมพู)'},
      {id:'836', text:'836 Lunar Lust (พีชธรรมชาติ)'}
    ];

    // ===== Elements =====
    const opt = document.getElementById('opt');
    const optM = document.getElementById('optM');
    const qty = document.getElementById('qty');
    const mQty = document.getElementById('mQty');
    const sheet = document.getElementById('sheet');
    const buy = document.getElementById('buy');
    const closeBtn = document.getElementById('close');
    const productField = document.getElementById('product');
    const orderIdField = document.getElementById('order_id');
    const phoneField = document.getElementById('phone');
    const submitBtn = document.getElementById('submitBtn');
    const toast = document.getElementById('toast');

    // ===== Render shade chips =====
    function renderChips() {
      [opt,optM].forEach(w=>{
        w.innerHTML='';
        SHADES.forEach(s=>{
          const b=document.createElement('button');
          b.type='button'; b.className='chip'; b.dataset.id=s.id; b.textContent=s.text;
          b.onclick=()=>selectShade(s.id);
          w.appendChild(b);
        });
      });
    }
    function selectShade(id){
      document.querySelectorAll('.options .chip').forEach(el=>{
        el.classList.toggle('selected', el.dataset.id===id);
      });
      updateProductEmbed();
    }

    function currentShadeText(){
      const el = document.querySelector('.options .chip.selected');
      return el ? el.textContent : SHADES[0].text;
    }

    // Default
    renderChips(); selectShade(SHADES[0].id);

    // Qty sync
    document.getElementById('minus').onclick=()=>{ if(qty.value>1){ qty.value--; mQty.value=qty.value; updateProductEmbed(); } };
    document.getElementById('plus').onclick =()=>{ qty.value++; mQty.value=qty.value; updateProductEmbed(); };
    document.getElementById('mMinus').onclick=()=>{ if(mQty.value>1){ mQty.value--; qty.value=mQty.value; updateProductEmbed(); } };
    document.getElementById('mPlus').onclick =()=>{ mQty.value++; qty.value=mQty.value; updateProductEmbed(); };
    qty.addEventListener('input',()=>{ if(qty.value<1) qty.value=1; mQty.value=qty.value; updateProductEmbed(); });
    mQty.addEventListener('input',()=>{ if(mQty.value<1) mQty.value=1; qty.value=mQty.value; updateProductEmbed(); });

    function updateProductEmbed(){
      const q = parseInt(qty.value||'1',10);
      productField.value = `M-BLITHE Magic Glow Lipstick - ${currentShadeText()} - ${PRICE} บาท x${q}`;
    }

    // Open/close sheet
    buy.onclick=()=>{
      sheet.style.display='block';
      const val = PRICE * parseInt(qty.value||'1',10);
      if(window.fbq){ fbq('track','AddToCart',{value:val,currency:'THB'}); fbq('track','InitiateCheckout',{value:val,currency:'THB'}); }
      if(window.ttq){ ttq.track('AddToCart'); ttq.track('InitiateCheckout'); }
      if(window.gtag){ gtag('event','begin_checkout',{value:val,currency:'THB'}); }
    };
    closeBtn.onclick=()=>sheet.style.display='none';
    sheet.addEventListener('click',e=>{ if(e.target===sheet) sheet.style.display='none'; });

    // LINE track
    function trackLine(){ if(window.fbq) fbq('track','Contact'); if(window.ttq) ttq.track('Contact'); }
    document.getElementById('lineTop').addEventListener('click',trackLine);
    document.getElementById('lineBottom').addEventListener('click',trackLine);

    // ===== Submit (ONLY 5 FIELDS) =====
    async function sendOrder(e){
      e.preventDefault();

      // สร้าง Order ID
      orderIdField.value = 'ORD-' + Date.now();

      // ป้องกันเลข 0 หาย: ถ้าคอลัมน์ Phone ตั้งค่าเป็น Plain text แล้ว
      // สามารถไม่ต้องเติม ' ได้ (ให้ตรงกับรูปตัวอย่างที่ไม่มี ' นำหน้า)
      // ถ้ายังหาย ให้ตั้ง Format → Plain text ที่คอลัมน์ D ในชีต

      // ล็อกปุ่ม
      const old = submitBtn.textContent;
      submitBtn.disabled=true; submitBtn.textContent='กำลังส่ง...';

      try{
        const form = new FormData(document.getElementById('orderForm'));
        const res = await fetch(APP_URL,{method:'POST',body:form});
        let ok=false, data=null;
        try{ data = await res.clone().json(); ok = data && data.result==='success'; }catch(_){ ok = res.ok; }
        submitBtn.disabled=false; submitBtn.textContent=old;

        if(ok){
          sheet.style.display='none';
          document.getElementById('orderForm').reset();
          qty.value=1; mQty.value=1; selectShade(SHADES[0].id); updateProductEmbed();

          toast.style.display='block'; setTimeout(()=>toast.style.display='none',2200);

          const total = PRICE; // ไม่จำเป็นต่อชีต แต่ใช้ยิงพิกเซล
          if(window.fbq) fbq('track','Purchase',{value:total,currency:'THB'});
          if(window.ttq) ttq.track('CompletePayment',{value:total,currency:'THB'});
          if(window.gtag) gtag('event','conversion',{'send_to':'AW-17035064059/53zPCNHE2OIaEPvl-bo_','value':total,'currency':'THB'});
        }else{
          alert('ส่งไม่สำเร็จ กรุณาลองใหม่ หรือติดต่อทางไลน์');
        }
      }catch(err){
        submitBtn.disabled=false; submitBtn.textContent=old;
        console.error(err); alert('มีข้อผิดพลาดในการส่งข้อมูล: '+(err.message||err));
      }
    }
  </script>
</body>
</html>
